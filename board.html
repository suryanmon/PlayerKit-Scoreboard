<!DOCTYPE html>
<html>
<head>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&display=swap');

        body { margin: 0; background: transparent; overflow: hidden; font-family: 'Oswald', sans-serif; }
        
        .container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 95%;
            max-width: 800px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        /* TOP: Match Header */
        .match-header {
            background: #232323;
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 4px solid #00acee;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
        }
        .teams { font-size: 20px; text-transform: uppercase; letter-spacing: 1px; color: #eee; }
        .main-score { font-size: 30px; font-weight: bold; color: #ffeb3b; }
        .target-badge { background: #444; padding: 4px 8px; border-radius: 4px; font-size: 16px; color: #aaa; }

        /* PLAYERS LIST (Rows) */
        .player-list { display: flex; flex-direction: column; gap: 6px; }

        .player-row {
            background: white;
            padding: 8px 15px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: all 0.5s ease; /* Smooth re-ordering */
        }

        /* MVP Styling (Top Player) */
        .player-row.mvp {
            background: linear-gradient(90deg, #FFD700 0%, #FFC107 100%); /* Gold Gradient */
            color: #000;
            border-left: 6px solid #b8860b;
            transform: scale(1.02); /* Slightly bigger */
            font-weight: bold;
        }

        .p-info { display: flex; align-items: center; gap: 10px; font-size: 18px; text-transform: uppercase; }
        .bat-icon { font-size: 16px; display: none; } /* Hidden by default */
        .batting .bat-icon { display: inline-block; } /* Show if batting */

        .p-stats { display: flex; gap: 15px; font-size: 20px; font-weight: bold; }
        .runs-val { color: #333; }
        .wkt-val { color: #d32f2f; }
        
        /* MVP Text Adjustments */
        .mvp .runs-val { color: #000; }
        .mvp .wkt-val { color: #c0392b; }

    </style>
</head>
<body>

    <div class="container" id="container" style="display:none;">
        
        <div class="match-header">
            <div class="teams"><span id="teamBat">TEAM A</span> <span style="opacity:0.6; font-size:16px;">VS</span> <span id="teamBowl">TEAM B</span></div>
            <div class="main-score"><span id="score">0-0</span> <span style="font-size:18px; color:white; opacity:0.8;">(<span id="overs">0.0</span>)</span></div>
            <div class="target-badge" id="targetBox" style="display:none;">TARGET: <span id="target">0</span></div>
        </div>

        <div class="player-list" id="playerList">
            </div>

    </div>

    <script>
        // --- YOUR KEYS ---
        const BIN_ID = '6937d64fae596e708f8d16a9'; 
        const API_KEY = '$2a$10$/hLwjwFuLAmOdHLdMG64ZeTBqP43JSwO3KQh/NZRjzu6hNtpCTAO6';
        // -----------------

        async function fetchScore() {
            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, { headers: { 'X-Master-Key': API_KEY } });
                const json = await res.json();
                const d = json.record;

                document.getElementById('container').style.display = "flex";

                // 1. Update Header
                setText('teamBat', d.teamBat || "TEAM A");
                setText('teamBowl', d.teamBowl || "TEAM B");
                setText('score', d.score || "0-0");
                setText('overs', d.overs || "0.0");
                
                const tgt = document.getElementById('targetBox');
                if(d.target && d.target > 0) {
                    tgt.style.display = "block";
                    setText('target', d.target);
                } else {
                    tgt.style.display = "none";
                }

                // 2. Build Player Array
                let players = [
                    { name: d.p1Name, runs: parseInt(d.p1Runs)||0, wkts: parseInt(d.p1Wkts)||0, isBat: d.p1Bat },
                    { name: d.p2Name, runs: parseInt(d.p2Runs)||0, wkts: parseInt(d.p2Wkts)||0, isBat: d.p2Bat },
                    { name: d.p3Name, runs: parseInt(d.p3Runs)||0, wkts: parseInt(d.p3Wkts)||0, isBat: d.p3Bat },
                    { name: d.p4Name, runs: parseInt(d.p4Runs)||0, wkts: parseInt(d.p4Wkts)||0, isBat: d.p4Bat }
                ];

                // 3. SORTING LOGIC (The Magic Part)
                // Score = Runs + (Wickets * 15). Adjust '15' if you value wickets more/less.
                players.sort((a, b) => {
                    let scoreA = a.runs + (a.wkts * 15);
                    let scoreB = b.runs + (b.wkts * 15);
                    return scoreB - scoreA; // Descending order
                });

                // 4. Render Rows
                const list = document.getElementById('playerList');
                list.innerHTML = ""; // Clear old list

                players.forEach((p, index) => {
                    // Create HTML for row
                    const isMVP = (index === 0 && (p.runs > 0 || p.wkts > 0)); // Only MVP if they have score > 0
                    const battingClass = p.isBat ? "batting" : "";
                    const mvpClass = isMVP ? "mvp" : "";
                    const name = p.name || "PLAYER";

                    const html = `
                        <div class="player-row ${mvpClass} ${battingClass}">
                            <div class="p-info">
                                <span class="bat-icon">üèè</span>
                                <span>${name}</span>
                            </div>
                            <div class="p-stats">
                                <span class="runs-val">${p.runs}</span>
                                <span class="wkt-val">${p.wkts}W</span>
                            </div>
                        </div>
                    `;
                    list.innerHTML += html;
                });

            } catch (e) { console.log(e); }
        }

        function setText(id, txt) {
            const el = document.getElementById(id);
            if(el) el.innerText = txt;
        }

        setInterval(fetchScore, 3000); // Update every 3 seconds
        fetchScore();
    </script>
</body>
</html>
