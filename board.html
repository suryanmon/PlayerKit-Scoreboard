<!DOCTYPE html>
<html>
<head>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&display=swap');

        body { margin: 0; background: transparent; overflow: hidden; font-family: 'Roboto Condensed', sans-serif; }
        
        .container {
            position: fixed;
            bottom: 20px; /* Sits at bottom */
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 600px; /* Keeps it short width-wise */
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        /* 1. THE SPLIT HEADER (TV Style) */
        .header-bar {
            display: flex;
            height: 45px; /* Compact Height */
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            font-weight: bold;
            text-transform: uppercase;
        }

        .bat-side {
            flex: 1;
            background: #0056b3; /* Blue */
            color: white;
            display: flex;
            align-items: center;
            padding-left: 15px;
            font-size: 18px;
        }
        
        .score-middle {
            flex: 0 0 120px; /* Fixed width for score */
            background: #111;
            color: #ffeb3b; /* Yellow Score */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            line-height: 1;
            position: relative;
        }
        .main-score { font-size: 24px; }
        .overs-small { font-size: 12px; color: #ccc; margin-top: 2px;}

        /* Target Popup */
        .target-tag { 
            position: absolute; top: -18px; background: #d32f2f; color: white; 
            font-size: 10px; padding: 2px 6px; border-radius: 3px; 
        }

        .bowl-side {
            flex: 1;
            background: #d32f2f; /* Red */
            color: white;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 15px;
            font-size: 18px;
        }

        /* 2. COMPACT PLAYER LIST */
        .player-list {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .player-row {
            background: rgba(255,255,255,0.9);
            padding: 4px 12px; /* Very thin rows */
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px; /* Smaller font */
            font-weight: bold;
            color: #333;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        /* MVP Gold Style */
        .mvp {
            background: linear-gradient(90deg, #FFD700, #ffecb3);
            border-left: 4px solid #b8860b;
        }

        .p-right span { margin-left: 8px; }
        .run-txt { font-size: 15px; }
        .wkt-txt { color: #c62828; }
        .bat-icon { display: none; margin-right: 5px; color: #333; }
        .batting .bat-icon { display: inline; }

    </style>
</head>
<body>

    <div class="container" id="container" style="display:none;">
        
        <div class="header-bar">
            <div class="bat-side" id="teamBat">BAT</div>
            <div class="score-middle">
                <span id="targetTag" class="target-tag" style="display:none">TGT: 0</span>
                <span class="main-score" id="score">0-0</span>
                <span class="overs-small" id="overs">0.0</span>
            </div>
            <div class="bowl-side" id="teamBowl">BOWL</div>
        </div>

        <div class="player-list" id="list">
            </div>

    </div>

    <script>
        // --- KEYS ---
        const BIN_ID = '6937d64fae596e708f8d16a9'; 
        const API_KEY = '$2a$10$/hLwjwFuLAmOdHLdMG64ZeTBqP43JSwO3KQh/NZRjzu6hNtpCTAO6';
        // ------------

        async function fetchScore() {
            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, { headers: { 'X-Master-Key': API_KEY } });
                const json = await res.json();
                const d = json.record;

                document.getElementById('container').style.display = "flex";

                // Header Updates
                document.getElementById('teamBat').innerText = d.teamBat || "TEAM A";
                document.getElementById('teamBowl').innerText = d.teamBowl || "TEAM B";
                document.getElementById('score').innerText = d.score || "0-0";
                document.getElementById('overs').innerText = d.overs || "0.0";
                
                // Target Display
                const tBox = document.getElementById('targetTag');
                if(d.target && d.target > 0) {
                    tBox.style.display = "block";
                    tBox.innerText = "TGT: " + d.target;
                } else {
                    tBox.style.display = "none";
                }

                // Players Logic
                let players = [];
                for(let i=1; i<=4; i++) {
                    players.push({
                        name: d[`p${i}Name`], 
                        runs: parseInt(d[`p${i}Runs`]||0), 
                        wkts: parseInt(d[`p${i}Wkts`]||0),
                        isBat: d[`p${i}Bat`]
                    });
                }

                // Sort: Highest Points (Runs + Wkts*15)
                players.sort((a,b) => (b.runs + b.wkts*15) - (a.runs + a.wkts*15));

                // Render
                const list = document.getElementById('list');
                list.innerHTML = "";
                
                players.forEach((p, idx) => {
                    const isMVP = (idx === 0 && (p.runs > 0 || p.wkts > 0));
                    const batClass = p.isBat ? "batting" : "";
                    const mvpClass = isMVP ? "mvp" : "";
                    
                    list.innerHTML += `
                    <div class="player-row ${mvpClass} ${batClass}">
                        <div><span class="bat-icon">üèè</span>${p.name || "Player"}</div>
                        <div class="p-right">
                            <span class="run-txt">${p.runs}</span>
                            <span class="wkt-txt">${p.wkts}W</span>
                        </div>
                    </div>`;
                });

            } catch (e) { console.log(e); }
        }

        setInterval(fetchScore, 3000);
        fetchScore();
    </script>
</body>
</html>
