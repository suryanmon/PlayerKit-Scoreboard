<!DOCTYPE html>
<html>
<head>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&display=swap');

        body { margin: 0; background: transparent; overflow: hidden; font-family: 'Roboto Condensed', sans-serif; }
        
        .container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        /* HEADER BAR */
        .header-bar {
            display: flex;
            height: 50px; /* Slightly taller to fit Target */
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            font-weight: bold;
            text-transform: uppercase;
        }

        .bat-side {
            flex: 1;
            background: #0056b3; /* Blue */
            color: white;
            display: flex;
            align-items: center;
            padding-left: 15px;
            font-size: 18px;
        }
        
        /* The Middle Score Box */
        .score-middle {
            flex: 0 0 130px; /* Width */
            background: #111;
            color: #ffeb3b;
            display: flex;
            flex-direction: column; /* Stack items vertically */
            align-items: center;
            justify-content: center;
            line-height: 1;
        }
        
        .target-txt { font-size: 12px; color: #ffab91; margin-bottom: 2px; display:none; } /* Orange Target */
        .main-score { font-size: 26px; }
        .overs-small { font-size: 12px; color: #ccc; margin-top: 2px;}

        .bowl-side {
            flex: 1;
            background: #d32f2f; /* Red */
            color: white;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 15px;
            font-size: 18px;
        }

        /* PLAYER LIST */
        .player-list {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .player-row {
            background: rgba(255,255,255,0.9);
            padding: 4px 12px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            font-weight: bold;
            color: #333;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        /* MVP Styling */
        .mvp {
            background: linear-gradient(90deg, #FFD700, #ffecb3);
            border-left: 4px solid #b8860b;
        }

        .p-right span { margin-left: 8px; }
        .run-txt { font-size: 15px; }
        .wkt-txt { color: #c62828; }
        .bat-icon { display: none; margin-right: 5px; color: #333; }
        .batting .bat-icon { display: inline; }

    </style>
</head>
<body>

    <div class="container" id="container" style="display:none;">
        
        <div class="header-bar">
            <div class="bat-side" id="teamBat">BAT</div>
            
            <div class="score-middle">
                <span id="targetTxt" class="target-txt">TGT: 0</span>
                <span class="main-score" id="score">0-0</span>
                <span class="overs-small" id="overs">0.0</span>
            </div>

            <div class="bowl-side" id="teamBowl">BOWL</div>
        </div>

        <div class="player-list" id="list">
            </div>

    </div>

    <script>
        // --- KEYS ---
        const BIN_ID = '6937d64fae596e708f8d16a9'; 
        const API_KEY = '$2a$10$/hLwjwFuLAmOdHLdMG64ZeTBqP43JSwO3KQh/NZRjzu6hNtpCTAO6';
        // ------------

        async function fetchScore() {
            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, { headers: { 'X-Master-Key': API_KEY } });
                const json = await res.json();
                const d = json.record;

                document.getElementById('container').style.display = "flex";

                // Update Texts
                document.getElementById('teamBat').innerText = d.teamBat || "TEAM A";
                document.getElementById('teamBowl').innerText = d.teamBowl || "TEAM B";
                document.getElementById('score').innerText = d.score || "0-0";
                document.getElementById('overs').innerText = d.overs || "0.0";
                
                // Target Logic
                const tBox = document.getElementById('targetTxt');
                if(d.target && d.target > 0) {
                    tBox.style.display = "block";
                    tBox.innerText = "TARGET: " + d.target;
                } else {
                    tBox.style.display = "none";
                }

                // Player Logic & Sorting
                let players = [];
                for(let i=1; i<=4; i++) {
                    players.push({
                        name: d[`p${i}Name`], 
                        runs: parseInt(d[`p${i}Runs`]||0), 
                        wkts: parseInt(d[`p${i}Wkts`]||0),
                        isBat: d[`p${i}Bat`]
                    });
                }
                players.sort((a,b) => (b.runs + b.wkts*15) - (a.runs + a.wkts*15));

                // Render List
                const list = document.getElementById('list');
                list.innerHTML = "";
                
                players.forEach((p, idx) => {
                    const isMVP = (idx === 0 && (p.runs > 0 || p.wkts > 0));
                    const batClass = p.isBat ? "batting" : "";
                    const mvpClass = isMVP ? "mvp" : "";
                    
                    list.innerHTML += `
                    <div class="player-row ${mvpClass} ${batClass}">
                        <div><span class="bat-icon">üèè</span>${p.name || "Player"}</div>
                        <div class="p-right">
                            <span class="run-txt">${p.runs}</span>
                            <span class="wkt-txt">${p.wkts}W</span>
                        </div>
                    </div>`;
                });

            } catch (e) { console.log(e); }
        }

        setInterval(fetchScore, 3000);
        fetchScore();
    </script>
</body>
</html>
