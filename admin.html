<!DOCTYPE html>
<html>
<head>
    <title>2v2 Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: sans-serif; background: #121212; color: white; padding: 15px; max-width: 500px; margin: auto; }
        .card { background: #1e1e1e; padding: 15px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.5); margin-bottom: 15px; border: 1px solid #333; }
        
        .row { display: flex; gap: 8px; margin-bottom: 8px; align-items: center;}
        input[type="text"], input[type="number"] { background: #2c2c2c; color: white; border: 1px solid #444; width: 100%; padding: 10px; border-radius: 6px; box-sizing: border-box; }
        input[type="color"] { border: none; width: 50px; height: 40px; cursor: pointer; background: transparent; }
        
        label { font-size: 10px; font-weight: bold; color: #888; text-transform: uppercase; margin-bottom: 4px; display:block; }
        .team-header { padding: 8px; border-radius: 4px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }

        .toggle-container { display: flex; background: #333; border-radius: 6px; padding: 2px; }
        .toggle-btn { flex: 1; padding: 10px; text-align: center; cursor: pointer; font-size: 12px; font-weight: bold; border-radius: 4px; color: #888; }
        .toggle-btn.active { background: #00acee; color: white; }
        input[type="radio"] { display: none; }

        .btn-update { width: 100%; padding: 15px; background: #00acee; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; font-weight: bold; box-shadow: 0 0 10px rgba(0, 172, 238, 0.4); }
        .btn-reset { width: 100%; padding: 12px; background: #d32f2f; color: white; border: none; border-radius: 8px; font-size: 14px; cursor: pointer; font-weight: bold; margin-top: 15px; opacity: 0.8; }
        
    </style>
</head>
<body>
    <h3 style="text-align:center; margin:0 0 15px 0;">üèè Match Controller</h3>

    <div class="card">
        <label>Who is Batting Now?</label>
        <div class="toggle-container">
            <label class="toggle-btn active" id="btnT1" onclick="setBatting('team1')">
                TEAM 1 (Left)
                <input type="radio" name="batSide" id="batSide1" value="team1" checked>
            </label>
            <label class="toggle-btn" id="btnT2" onclick="setBatting('team2')">
                TEAM 2 (Right)
                <input type="radio" name="batSide" id="batSide2" value="team2">
            </label>
        </div>

        <div style="margin-top:15px;"></div>

        <div class="row">
            <div style="flex:1">
                <label>Score</label>
                <input type="text" id="score" placeholder="0-0">
            </div>
            <div style="flex:1">
                <label>Overs</label>
                <input type="text" id="overs" placeholder="0.0">
            </div>
            <div style="flex:1">
                <label>Target</label>
                <input type="number" id="target" placeholder="0">
            </div>
        </div>
        
        <div class="row">
            <div style="flex:1">
                <label>Opponent / Previous Score</label>
                <input type="text" id="oppScore" placeholder="e.g. PANGERS 24-2">
            </div>
        </div>

    </div>

    <div class="card" style="border-left: 4px solid #fff;" id="card1">
        <div class="team-header">
            <span>TEAM 1 (Left)</span>
            <input type="color" id="color1" value="#0277bd" onchange="updateColors()">
        </div>
        <input type="text" id="team1Name" placeholder="Team Name" style="margin-bottom:10px;">
        <div class="row">
            <div style="flex:2"><label>P1 Name</label><input type="text" id="p1Name" placeholder="Name"></div>
            <div style="flex:1"><label>Runs</label><input type="number" id="p1Runs" placeholder="0"></div>
            <div style="flex:1"><label>Wkts</label><input type="number" id="p1Wkts" placeholder="0"></div>
        </div>
        <div class="row">
            <div style="flex:2"><label>P2 Name</label><input type="text" id="p2Name" placeholder="Name"></div>
            <div style="flex:1"><label>Runs</label><input type="number" id="p2Runs" placeholder="0"></div>
            <div style="flex:1"><label>Wkts</label><input type="number" id="p2Wkts" placeholder="0"></div>
        </div>
    </div>

    <div class="card" style="border-right: 4px solid #fff;" id="card2">
        <div class="team-header">
            <span>TEAM 2 (Right)</span>
            <input type="color" id="color2" value="#c62828" onchange="updateColors()">
        </div>
        <input type="text" id="team2Name" placeholder="Team Name" style="margin-bottom:10px;">
        <div class="row">
            <div style="flex:2"><label>P3 Name</label><input type="text" id="p3Name" placeholder="Name"></div>
            <div style="flex:1"><label>Runs</label><input type="number" id="p3Runs" placeholder="0"></div>
            <div style="flex:1"><label>Wkts</label><input type="number" id="p3Wkts" placeholder="0"></div>
        </div>
        <div class="row">
            <div style="flex:2"><label>P4 Name</label><input type="text" id="p4Name" placeholder="Name"></div>
            <div style="flex:1"><label>Runs</label><input type="number" id="p4Runs" placeholder="0"></div>
            <div style="flex:1"><label>Wkts</label><input type="number" id="p4Wkts" placeholder="0"></div>
        </div>
    </div>

    <button onclick="updateScore()" id="btn" class="btn-update">UPDATE BOARD</button>
    <button onclick="resetBoard()" class="btn-reset">‚ö†Ô∏è RESET SCORES</button>
    
    <div id="status" style="text-align:center; margin-top:10px; font-size:12px; color:#888;">Ready</div>

    <script>
        // --- KEYS ---
        const BIN_ID = '6937d64fae596e708f8d16a9'; 
        const API_KEY = '$2a$10$/hLwjwFuLAmOdHLdMG64ZeTBqP43JSwO3KQh/NZRjzu6hNtpCTAO6';
        // ------------

        const ids = ['team1Name', 'team2Name', 'color1', 'color2', 'score', 'overs', 'target', 'oppScore',
                     'p1Name', 'p1Runs', 'p1Wkts', 'p2Name', 'p2Runs', 'p2Wkts', 
                     'p3Name', 'p3Runs', 'p3Wkts', 'p4Name', 'p4Runs', 'p4Wkts'];

        function setBatting(team) {
            document.getElementById('btnT1').className = team === 'team1' ? 'toggle-btn active' : 'toggle-btn';
            document.getElementById('btnT2').className = team === 'team2' ? 'toggle-btn active' : 'toggle-btn';
            document.getElementById('batSide1').checked = (team === 'team1');
            document.getElementById('batSide2').checked = (team === 'team2');
        }

        function updateColors() {
            document.getElementById('card1').style.borderColor = document.getElementById('color1').value;
            document.getElementById('card2').style.borderColor = document.getElementById('color2').value;
        }

        // Load
        fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {headers: {'X-Master-Key': API_KEY}})
            .then(res => res.json()).then(json => {
                const d = json.record;
                ids.forEach(id => { if(document.getElementById(id)) document.getElementById(id).value = d[id] || ""; });
                setBatting(d.battingSide || 'team1');
                updateColors();
            });

        function updateScore() {
            document.getElementById('btn').innerText = "Updating...";
            let data = {};
            ids.forEach(id => data[id] = document.getElementById(id).value);
            data.battingSide = document.getElementById('batSide1').checked ? 'team1' : 'team2';

            fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
                method: 'PUT', headers: { 'Content-Type': 'application/json', 'X-Master-Key': API_KEY }, body: JSON.stringify(data)
            }).then(() => {
                document.getElementById('btn').innerText = "UPDATE BOARD";
                document.getElementById('status').innerText = "Updated!";
            });
        }

        function resetBoard() {
            if(!confirm("‚ö†Ô∏è Are you sure? This will reset SCORES to 0 but keep names.")) return;
            const resetIds = ['score', 'overs', 'target', 'oppScore', 'p1Runs', 'p1Wkts', 'p2Runs', 'p2Wkts', 'p3Runs', 'p3Wkts', 'p4Runs', 'p4Wkts'];
            resetIds.forEach(id => document.getElementById(id).value = "");
            updateScore(); 
        }
    </script>
</body>
</html>
